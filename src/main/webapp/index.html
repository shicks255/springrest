<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test The Amazon Purchases Rest Service</title>

    <style>
        table td{
            border : 1px solid black;
        }
    </style>

    <script>

        function searchForId(element)
        {
            if (isNaN(element.value))
            {
                alert('Must be a numeric value');
                element.value = '';
                return;
            }

            var purchaseId = element.value;
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function()
            {
                if (this.readyState == 4 && this.status == 200)
                {
                    var purchase = JSON.parse(xhttp.responseText);
                    if (purchase)
                    {
                        var form = document.createElement("form");
                        form.setAttribute("method", "PUT");
                        form.setAttribute("name", "frmUpdatePurchase");
                        form.setAttribute("id", "frmUpdatePurchase");
                        form.setAttribute("action", "/purchases/" + purchase['objectId']);


                        var table = document.createElement("table");

                        for (i in purchase)
                        {
                            var tr = document.createElement('tr');
                            var td1 = document.createElement('td');
                            var td2 = document.createElement('td');

                            var input = document.createElement('input');
                            input.setAttribute("type", "text");
                            input.setAttribute("name", i);
                            input.setAttribute("id", i);
                            input.setAttribute("value", purchase[i]);

                            var text = document.createTextNode(i);
                            var text2 = document.createTextNode(purchase[i]);

                            input.appendChild(text2)
                            td2.appendChild(input);
                            td1.appendChild(text);
                            tr.appendChild(td1);
                            tr.appendChild(td2);
                            table.appendChild(tr);
                        }

                        var editButton = document.createElement('button');
                        editButton.innerText = 'Update';
                        editButton.onclick = () =>
                        {
                            console.log(this);
                            console.log('hi');
                        };

                        var deleteButton = document.createElement('button');
                        deleteButton.innerText = 'Delete';
                        deleteButton.onclick = () =>
                        {

                        };

                        var box = document.getElementById('idSearchResponseBox');

                        form.appendChild(table);
                        box.appendChild(form);
                        box.appendChild(editButton);

                    }
                }
            }
            xhttp.open("GET", "/purchases/" + purchaseId, true);
            xhttp.send();
        }

        function searchForText(element)
        {
            var searchTerms = element.value;

            var xhhtp = new XMLHttpRequest();
            xhhtp.onreadystatechange = function()
            {
                if (this.readyState == 4 && this.status == 200)
                {

                }
            };
            xhhtp.open("GET", "/purchases/search?searchTerms=" + searchTerms);
            xhhtp.send();
        }

    </script>
</head>
<body>


<label for="idSearch">Search for a Purchase</label>
<br/>
<input type="text" name="idSearch" id="idSearch" placeholder="Enter an Object Id">
<button value="Search" onclick="searchForId(this.previousElementSibling);">Search</button>
<div id="idSearchResponseBox" name="idSearchResponseBox"></div>
<hr>

<label for="textSearch">Search for a Purchase</label>
<br/>
<input type="text" name="textSearch" id="textSearch" placeholder="Enter a search value">
<button value="Search" onclick="searchForText(this.previousElementSibling);">Search</button>
<div id="textSearchResponseBox" name="textSearchResponseBox"/>
<hr>



</body>
</html>